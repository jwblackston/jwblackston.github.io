<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.4.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Walker Blackston">

  
  
  
    
  
  <meta name="description" content="from keras.datasets import imdb (train_data, train_labels), (test_data, test_labels) = imdb.load_data(num_words=10000)  Using TensorFlow backend. WARNING: Logging before flag parsing goes to stderr. W0714 11:56:20.828102 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead. W0714 11:56:20.828986 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.AttrValue is deprecated. Please use tf.compat.v1.AttrValue instead. W0714 11:56:20.829607 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.COMPILER_VERSION is deprecated. Please use tf.version.COMPILER_VERSION instead. W0714 11:56:20.830371 4610053568 deprecation_wrapper.">

  
  <link rel="alternate" hreflang="en-us" href="/post/imdb-rating-prediction-v1/">

  


  

  
  
  
  <meta name="theme-color" content="#4caf50">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.7dd90def5016c13c0f90c2d17b2f5d5c.css">

  

  
  
  

  

  

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/imdb-rating-prediction-v1/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Walker Blackston">
  <meta property="og:url" content="/post/imdb-rating-prediction-v1/">
  <meta property="og:title" content="Imdb Rating Prediction V1 | Walker Blackston">
  <meta property="og:description" content="from keras.datasets import imdb (train_data, train_labels), (test_data, test_labels) = imdb.load_data(num_words=10000)  Using TensorFlow backend. WARNING: Logging before flag parsing goes to stderr. W0714 11:56:20.828102 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead. W0714 11:56:20.828986 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.AttrValue is deprecated. Please use tf.compat.v1.AttrValue instead. W0714 11:56:20.829607 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.COMPILER_VERSION is deprecated. Please use tf.version.COMPILER_VERSION instead. W0714 11:56:20.830371 4610053568 deprecation_wrapper."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-08-16T11:43:07&#43;01:00">
  
  <meta property="article:modified_time" content="2019-08-16T11:43:07&#43;01:00">
  

  


  





  <title>Imdb Rating Prediction V1 | Walker Blackston</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Walker Blackston</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/cv.pdf"><span>CV</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Imdb Rating Prediction V1</h1>

  

  
    



<meta content="2019-08-16 11:43:07 &#43;0100 BST" itemprop="datePublished">
<meta content="2019-08-16 11:43:07 &#43;0100 BST" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Aug 16, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  

  
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/imdb-rating-prediction-v1/&amp;text=Imdb%20Rating%20Prediction%20V1" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/imdb-rating-prediction-v1/&amp;t=Imdb%20Rating%20Prediction%20V1" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Imdb%20Rating%20Prediction%20V1&amp;body=/post/imdb-rating-prediction-v1/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/imdb-rating-prediction-v1/&amp;title=Imdb%20Rating%20Prediction%20V1" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Imdb%20Rating%20Prediction%20V1%20/post/imdb-rating-prediction-v1/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/imdb-rating-prediction-v1/&amp;title=Imdb%20Rating%20Prediction%20V1" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<pre><code class="language-python">from keras.datasets import imdb

(train_data, train_labels), (test_data, test_labels) = imdb.load_data(num_words=10000)
</code></pre>

<pre><code>Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0714 11:56:20.828102 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

W0714 11:56:20.828986 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.AttrValue is deprecated. Please use tf.compat.v1.AttrValue instead.

W0714 11:56:20.829607 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.COMPILER_VERSION is deprecated. Please use tf.version.COMPILER_VERSION instead.

W0714 11:56:20.830371 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.CXX11_ABI_FLAG is deprecated. Please use tf.sysconfig.CXX11_ABI_FLAG instead.

W0714 11:56:20.831021 4610053568 deprecation_wrapper.py:118] From /Users/walker/anaconda3/lib/python3.7/site-packages/tensorflow/__init__.py:98: The name tf.ConditionalAccumulator is deprecated. Please use tf.compat.v1.ConditionalAccumulator instead.
</code></pre>

<pre><code class="language-python">#inspect data:
train_data[0]
</code></pre>

<pre><code>[1,
 14,
 22,
 16,
 43,
 530,
 973,
 1622,
 1385,
 65,
 458,
 4468,
 66,
 3941,
 4,
 173,
 36,
 256,
 5,
 25,
 100,
 43,
 838,
 112,
 50,
 670,
 2,
 9,
 35,
 480,
 284,
 5,
 150,
 4,
 172,
 112,
 167,
 2,
 336,
 385,
 39,
 4,
 172,
 4536,
 1111,
 17,
 546,
 38,
 13,
 447,
 4,
 192,
 50,
 16,
 6,
 147,
 2025,
 19,
 14,
 22,
 4,
 1920,
 4613,
 469,
 4,
 22,
 71,
 87,
 12,
 16,
 43,
 530,
 38,
 76,
 15,
 13,
 1247,
 4,
 22,
 17,
 515,
 17,
 12,
 16,
 626,
 18,
 2,
 5,
 62,
 386,
 12,
 8,
 316,
 8,
 106,
 5,
 4,
 2223,
 5244,
 16,
 480,
 66,
 3785,
 33,
 4,
 130,
 12,
 16,
 38,
 619,
 5,
 25,
 124,
 51,
 36,
 135,
 48,
 25,
 1415,
 33,
 6,
 22,
 12,
 215,
 28,
 77,
 52,
 5,
 14,
 407,
 16,
 82,
 2,
 8,
 4,
 107,
 117,
 5952,
 15,
 256,
 4,
 2,
 7,
 3766,
 5,
 723,
 36,
 71,
 43,
 530,
 476,
 26,
 400,
 317,
 46,
 7,
 4,
 2,
 1029,
 13,
 104,
 88,
 4,
 381,
 15,
 297,
 98,
 32,
 2071,
 56,
 26,
 141,
 6,
 194,
 7486,
 18,
 4,
 226,
 22,
 21,
 134,
 476,
 26,
 480,
 5,
 144,
 30,
 5535,
 18,
 51,
 36,
 28,
 224,
 92,
 25,
 104,
 4,
 226,
 65,
 16,
 38,
 1334,
 88,
 12,
 16,
 283,
 5,
 16,
 4472,
 113,
 103,
 32,
 15,
 16,
 5345,
 19,
 178,
 32]
</code></pre>

<pre><code class="language-python">train_labels[0]
</code></pre>

<pre><code>1
</code></pre>

<pre><code class="language-python">max([max(sequence) for sequence in train_data])
</code></pre>

<pre><code>9999
</code></pre>

<pre><code class="language-python">#we need to vectorize our data:
import numpy as np
def vect_seq(sequences, dimension=10000):
    # Create an all-zero matrix of shape (len(sequences), dimension)
    results = np.zeros((len(sequences), dimension))
    for i, sequence in enumerate(sequences):
        results[i, sequence] = 1. # set specific indices of results[i] to 1s
    return results
</code></pre>

<pre><code class="language-python"># Our vectorized training data
x_train = vect_seq(train_data)
# Our vectorized test data
x_test = vect_seq(test_data)
</code></pre>

<pre><code class="language-python">x_train[0]
</code></pre>

<pre><code>array([0., 1., 1., ..., 0., 0., 0.])
</code></pre>

<pre><code class="language-python">y_train = np.asarray(train_labels).astype('float32')
y_test = np.asarray(test_labels).astype('float32')
</code></pre>

<pre><code class="language-python">from keras import models
from keras import layers
model = models.Sequential()
model.add(layers.Dense(16, activation='relu', input_shape=(10000,)))
model.add(layers.Dense(16, activation='relu'))
model.add(layers.Dense(1, activation='sigmoid'))
</code></pre>

<pre><code class="language-python">#compile the data
#model.compile(optimizer='rmsprop',
    #loss='binary_crossentropy',
    #metrics=['accuracy'])
</code></pre>

<pre><code class="language-python">from keras import optimizers

model.compile(optimizer=optimizers.RMSprop(lr=0.001),
    loss='binary_crossentropy',
    metrics=['accuracy'])
</code></pre>

<h3 id="compiling-our-model-with-custom-parameters">Compiling our model (with custom parameters):</h3>

<pre><code class="language-python">from keras import losses
from keras import metrics

model.compile(optimizer=optimizers.RMSprop(lr=0.001),
    loss=losses.binary_crossentropy,
    metrics=[metrics.binary_accuracy])
</code></pre>

<pre><code class="language-python">x_val = x_train[:10000]
partial_x_train = x_train[10000:]
y_val = y_train[:10000]
partial_y_train = y_train[10000:]
</code></pre>

<pre><code class="language-python">history = model.fit(partial_x_train,
    partial_y_train,
    epochs=20,
    batch_size=512,
validation_data=(x_val, y_val))
</code></pre>

<pre><code>Train on 15000 samples, validate on 10000 samples
Epoch 1/20
15000/15000 [==============================] - 3s 215us/step - loss: 0.5344 - binary_accuracy: 0.7747 - val_loss: 0.3907 - val_binary_accuracy: 0.8705
Epoch 2/20
15000/15000 [==============================] - 2s 126us/step - loss: 0.3168 - binary_accuracy: 0.8983 - val_loss: 0.3264 - val_binary_accuracy: 0.8717
Epoch 3/20
15000/15000 [==============================] - 2s 120us/step - loss: 0.2334 - binary_accuracy: 0.9249 - val_loss: 0.2858 - val_binary_accuracy: 0.8875
Epoch 4/20
15000/15000 [==============================] - 2s 119us/step - loss: 0.1832 - binary_accuracy: 0.9401 - val_loss: 0.2746 - val_binary_accuracy: 0.8903
Epoch 5/20
15000/15000 [==============================] - 2s 120us/step - loss: 0.1518 - binary_accuracy: 0.9517 - val_loss: 0.3000 - val_binary_accuracy: 0.8805
Epoch 6/20
15000/15000 [==============================] - 2s 119us/step - loss: 0.1223 - binary_accuracy: 0.9635 - val_loss: 0.2894 - val_binary_accuracy: 0.8855
Epoch 7/20
15000/15000 [==============================] - 2s 120us/step - loss: 0.1069 - binary_accuracy: 0.9656 - val_loss: 0.3041 - val_binary_accuracy: 0.8848
Epoch 8/20
15000/15000 [==============================] - 2s 119us/step - loss: 0.0857 - binary_accuracy: 0.9753 - val_loss: 0.3232 - val_binary_accuracy: 0.8788
Epoch 9/20
15000/15000 [==============================] - 2s 119us/step - loss: 0.0693 - binary_accuracy: 0.9827 - val_loss: 0.3418 - val_binary_accuracy: 0.8801
Epoch 10/20
15000/15000 [==============================] - 2s 119us/step - loss: 0.0594 - binary_accuracy: 0.9847 - val_loss: 0.3804 - val_binary_accuracy: 0.8773
Epoch 11/20
15000/15000 [==============================] - 2s 121us/step - loss: 0.0461 - binary_accuracy: 0.9899 - val_loss: 0.3959 - val_binary_accuracy: 0.8739
Epoch 12/20
15000/15000 [==============================] - 2s 119us/step - loss: 0.0375 - binary_accuracy: 0.9927 - val_loss: 0.4292 - val_binary_accuracy: 0.8779
Epoch 13/20
15000/15000 [==============================] - 2s 118us/step - loss: 0.0295 - binary_accuracy: 0.9947 - val_loss: 0.4603 - val_binary_accuracy: 0.8683
Epoch 14/20
15000/15000 [==============================] - 2s 123us/step - loss: 0.0247 - binary_accuracy: 0.9956 - val_loss: 0.4999 - val_binary_accuracy: 0.8745
Epoch 15/20
15000/15000 [==============================] - 2s 118us/step - loss: 0.0210 - binary_accuracy: 0.9955 - val_loss: 0.5153 - val_binary_accuracy: 0.8703
Epoch 16/20
15000/15000 [==============================] - 2s 117us/step - loss: 0.0118 - binary_accuracy: 0.9991 - val_loss: 0.5965 - val_binary_accuracy: 0.8665
Epoch 17/20
15000/15000 [==============================] - 2s 118us/step - loss: 0.0124 - binary_accuracy: 0.9984 - val_loss: 0.5746 - val_binary_accuracy: 0.8690
Epoch 18/20
15000/15000 [==============================] - 2s 121us/step - loss: 0.0077 - binary_accuracy: 0.9994 - val_loss: 0.7067 - val_binary_accuracy: 0.8470
Epoch 19/20
15000/15000 [==============================] - 2s 119us/step - loss: 0.0054 - binary_accuracy: 0.9998 - val_loss: 0.6341 - val_binary_accuracy: 0.8669
Epoch 20/20
15000/15000 [==============================] - 2s 118us/step - loss: 0.0072 - binary_accuracy: 0.9987 - val_loss: 0.6585 - val_binary_accuracy: 0.8656
</code></pre>

<pre><code class="language-python">history_dict = history.history

history_dict.keys()
</code></pre>

<pre><code>dict_keys(['val_loss', 'val_binary_accuracy', 'loss', 'binary_accuracy'])
</code></pre>

<h3 id="training-and-validation-loss">Training and Validation loss:</h3>

<pre><code class="language-python">import matplotlib.pyplot as plt

acc = history.history['binary_accuracy']
val_acc = history.history['val_binary_accuracy']
loss = history.history['loss']
val_loss = history.history['val_loss']
epochs = range(1, len(acc) + 1)

# &quot;bo&quot; is for &quot;blue dot&quot;
plt.plot(epochs, loss, 'bo', label='Training loss')

# b is for &quot;solid blue line&quot;
plt.plot(epochs, val_loss, 'b', label='Validation loss')

plt.title('Training and validation loss')
plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.legend()

plt.show()
</code></pre>

<pre><code>&lt;Figure size 640x480 with 1 Axes&gt;
</code></pre>

<h3 id="training-and-validation-accuracy">Training and Validation Accuracy:</h3>

<pre><code class="language-python">plt.clf() # clears prior figure 
acc_values = history_dict['binary_accuracy']
val_acc_values = history_dict['val_binary_accuracy']

plt.plot(epochs, acc, 'bo', label='Training acc')
plt.plot(epochs, val_acc, 'b', label='Validation acc')
plt.title('Training and validation accuracy')
plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.legend()

plt.show()
</code></pre>

<p><img src="imdb-rating-prediction-v1_files/imdb-rating-prediction-v1_19_0.png" alt="png" /></p>

<p>This comparison is a primary exampe of overfitting. Look at the difference of how metrics of accuracy and loss peak around the fourth epoch.</p>

<p>An appropriate response could be to simply stop our fitting of training data at 4 epochs. Let&rsquo;s do this now:</p>

<pre><code class="language-python">#train new model from scratch
model = models.Sequential()

model.add(layers.Dense(16, activation='relu', input_shape=(10000,)))
model.add(layers.Dense(16, activation='relu'))
model.add(layers.Dense(1, activation='sigmoid'))

model.compile(optimizer='rmsprop',
    loss='binary_crossentropy',
    metrics=['accuracy'])

model.fit(x_train, y_train, epochs=4, batch_size=512)

results = model.evaluate(x_test, y_test)
</code></pre>

<pre><code>Epoch 1/4
25000/25000 [==============================] - 2s 82us/step - loss: 0.4749 - acc: 0.8217
Epoch 2/4
25000/25000 [==============================] - 2s 74us/step - loss: 0.2666 - acc: 0.9094
Epoch 3/4
25000/25000 [==============================] - 2s 74us/step - loss: 0.1985 - acc: 0.9294
Epoch 4/4
25000/25000 [==============================] - 2s 74us/step - loss: 0.1680 - acc: 0.9405
25000/25000 [==============================] - 2s 77us/step
</code></pre>

<pre><code class="language-python">results
</code></pre>

<pre><code>[0.32515703952789304, 0.87256]
</code></pre>

<h3 id="now-we-would-like-to-implement-our-model-using-new-data">Now, we would like to implement our model using new data:</h3>

<ul>
<li>What are the likelihoods of generating positive reviews? Use &lsquo;predict&rsquo; function from Keras:</li>
</ul>

<pre><code class="language-python">model.predict(x_test)
</code></pre>

<pre><code>array([[0.13455817],
       [0.99970734],
       [0.2682383 ],
       ...,
       [0.07024318],
       [0.0425705 ],
       [0.47154084]], dtype=float32)
</code></pre>

<p>This shows a wide range of prediction accuracy- from 0.13 to upwards of 0.99.</p>

<p><em>What else can we do to improve?</em></p>

<h2 id="next-steps"><em>Next steps:</em></h2>

<p>1) We could use a different number of hidden layers (in this example we trained 2 layers)
2) Our layers could contain a different number of &lsquo;units&rsquo;
3) Our loss function could be re-tooled- using &lsquo;mse&rsquo; rather than binary cross entropy
4) We could implement a different method of lahyer activation. We have been using &lsquo;relu&rsquo; but what of other methods, such as the common &lsquo;tanh&rsquo; activation function?</p>

<p><strong>Let&rsquo;s be good scientists and experiment with all (holding other variables equal), with the explicit goal of improving our model accuracy and efficiency.</strong></p>

<h1 id="note-model-tuning-to-be-accomplished-in-volume-2-of-this-notebook"><em>NOTE:  MODEL TUNING TO BE ACCOMPLISHED IN VOLUME 2 OF THIS NOTEBOOK.</em></h1>

    </div>

    


    



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_hu949f3ebb3444a38c1d213c8ca6e9c58e_34303_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">Walker Blackston</a></h5>
      <h6 class="card-subtitle">PhD Student in Epidemiology and Biostatistics</h6>
      <p class="card-text" itemprop="description">I am a first year PhD student in Epidemiology and Biostatistics at Tulane University. My research interests lie at the intersection of epidemiological methods, causal inference, nutrition, and cardiometabolic kidney diseases.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://twitter.com/BlackstonWalker" target="_blank" rel="noopener">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/jwblackston" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
      

      
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.4e51017b38c7ebaadd7e25fc9503f88c.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    &copy; Walker Blackston 2019 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
